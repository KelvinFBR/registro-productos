const g=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerpolicy&&(c.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?c.credentials="include":o.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(o){if(o.ep)return;o.ep=!0;const c=r(o);fetch(o.href,c)}};g();const a=()=>{if(localStorage.getItem("product"))return JSON.parse(localStorage.getItem("product"))},y=document.querySelector("#total-price"),S=document.querySelector("#total-amount"),h=()=>{const e=[];a().forEach(t=>{e.push(t.price*1)}),y.textContent=e.reduce((t,r)=>r+t,0)},P=()=>{const e=[];a().forEach(t=>{e.push(t.amount*1)}),S.textContent=e.reduce((t,r)=>r+t,0)},s=e=>{h(),P()},b=document.querySelector("#row-product").content,m=document.querySelector("#body-table"),v=(e,t,r,n)=>{let o=JSON.parse(localStorage.getItem("product"));o.push({id:e,name:t,price:n,amount:r}),localStorage.setItem("product",JSON.stringify(o))},p=(e,t,r,n)=>{const o=b.cloneNode(!0);o.querySelector(".id").textContent=e,o.querySelector(".name").textContent=t,o.querySelector(".amount").textContent=r,o.querySelector(".price").textContent=n,m.appendChild(o)},i=e=>{m.textContent="",e.forEach(t=>{const{id:r,name:n,amount:o,price:c}=t;p(r,n,o,c)})},u=document.getElementById("form"),f={id:""},E=()=>{const e=u.elements[3];e.type="reset",e.textContent="Actualizar",e.addEventListener("click",()=>{if(e.textContent==="Actualizar"){let t=a();t.forEach(r=>{r.id===f.id&&(r.name=u.name.value,r.amount=u.amount.value,r.price=u.price.value)}),localStorage.setItem("product",JSON.stringify(t)),i(a()),s(),e.textContent="Registrar",setTimeout(()=>{e.type="submit"},1e3)}})},C=e=>{let t=a();t=t.filter(r=>r.id!==e),localStorage.setItem("product",JSON.stringify(t)),i(a())},I=e=>{let t=a();t=t.find(r=>r.id===e),u.name.value=t.name,u.amount.value=t.amount,u.price.value=t.price,f.id=e,E()},d=document.getElementById("form"),N=(e,t)=>{e.preventDefault();let r=JSON.stringify(new Date().getTime());//!   modificacion
r=r.slice(9,13);const n=new FormData(d),o=n.get("name"),c=n.get("amount"),l=n.get("price");return d.reset(),t(r,o,c,l)},x=document.getElementById("form");window.addEventListener("load",async()=>{localStorage.getItem("product")||localStorage.setItem("product",JSON.stringify([])),i(a()),s()});x.addEventListener("submit",e=>{N(e,(t,r,n,o)=>{p(t,r,n,o),v(t,r,n,o),s()})});document.addEventListener("click",e=>{if(e.target.matches("#btn-delete")||e.target.matches("#btn-update")){let t=e.target.parentElement.parentElement.querySelector(".id").textContent;e.target.matches("#btn-delete")&&(C(t),s()),e.target.matches("#btn-update")&&I(t)}});
